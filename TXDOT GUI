# Attempt at creating a gui for a new mr entry

import pandas as pd
from pandas import Series, DataFrame
import numpy as np
import csv
import tkinter as tk
from tkinter import ttk
from tkinter import filedialog
import os
import datetime

LARGE_FONT= ("Verdana", 12)
    

class P2P_Gui(tk.Tk):

    def __init__(self, *args, **kwargs):
        
        tk.Tk.__init__(self, *args, **kwargs)
        
        tk.Tk.wm_title(self, 'IMD Procurement MR Database')
        
        container = tk.Frame(self)
        container.pack(side="top", fill="both", expand = True)

        container.grid_rowconfigure(0, weight=1)
        container.grid_columnconfigure(0, weight=1)

        self.frames = {}
        
        for F in (HomePage, EntryPage, SearchPage, ReqPage, PoPage, RecPage, TaskPage, ReportPage, VoucherPage):

            frame = F(container, self)

            self.frames[F] = frame

            frame.grid(row=0, column=0, sticky="nsew")

        self.show_frame(HomePage)

    def show_frame(self, cont):

        frame = self.frames[cont]
        frame.tkraise() 


class MessageBoxes(P2P_Gui):
        
    def close_message(self):

        self.close_popup = tk.Tk()
        self.close_popup.wm_title('!')

        label = ttk.Label(self.close_popup, text='Are you sure you want to quit?')
        label.pack(side='top', fill='x', pady=10)

        yes_button = ttk.Button(self.close_popup, text='Yes', command = self.close_program)
        yes_button.pack(side='left')

        no_button = ttk.Button(self.close_popup, text='No', command = self.close_allmessage)
        no_button.pack(side='right')
        
        self.close_popup.mainloop()

    def check_message(self):

        self.check_popup = tk.Tk()
        self.check_popup.wm_title('!')

        label = ttk.Label(self.check_popup, text='Are you sure you want to submit?')
        label.pack(side='top', fill='x', pady=10)

        yes_button = ttk.Button(self.check_popup, text='Yes', command = self.combo_command)
        yes_button.pack(side='left')

        no_button = ttk.Button(self.check_popup, text='No', command = self.check_popup.destroy)
        no_button.pack(side='right')
        
        self.check_popup.mainloop()
        
    def close_allmessage(self):
        
        self.close_popup.destroy()
        self.check_popup.destroy()
        
    def close_program(self):

        app.destroy()
        self.close_allmessage()
        
            
class HomePage(tk.Frame, MessageBoxes):

    def __init__(self, parent, controller):
        
        tk.Frame.__init__(self,parent)
        label = ttk.Label(self, text='What Would You Like to Do?', font=LARGE_FONT)
        label.pack(pady=10,padx=10)
        
        entry_button = ttk.Button(self, text='New Entry', command= lambda: controller.show_frame(EntryPage))
        entry_button.pack()
        
        lookup_button = ttk.Button(self, text='MR Lookup', command= lambda: controller.show_frame(SearchPage))
        lookup_button.pack()
        
        report_button = ttk.Button(self, text='Run Report', command= lambda: controller.show_frame(ReportPage))
        report_button.pack()
        
        quit_button = ttk.Button(self, text='Exit', command= self.close_message)
        quit_button.pack()
        

class EntryPage(tk.Frame, MessageBoxes):
    
    def __init__(self, parent, controller):
        
        tk.Frame.__init__(self,parent)
        self.label = ttk.Label(self, text="New MR Entry", font=LARGE_FONT)
        self.label.pack(pady=10,padx=10)

        self.label = ttk.Label(self, text= 'Enter Ticket Number')
        self.label.pack()
        self.entry1 = ttk.Entry(self)
        self.entry1.pack()
        self.entry1.focus_set()
    
        self.label = ttk.Label(self, text= 'Enter Requisition ID')
        self.label.pack()
        self.entry2 = ttk.Entry(self)
        self.entry2.pack()
        self.entry2.focus_set()
        
        self.enter_button = ttk.Button(self, text='Enter', command= self.check_message)
        self.enter_button.pack()
        
        self.clear_button = ttk.Button(self, text='Clear', command=self.clear_textbox)
        self.clear_button.pack()
        
        self.home_button = ttk.Button(self, text='Home', command= lambda: controller.show_frame(HomePage))
        self.home_button.pack()

    def write_file(self):
        
        with open ('T:\FISCAL\FY 2019\PURCHASING 2019\P2P RAW DATA\MRONSTEROIDS.csv', 'a', newline='') as f:
            w = csv.writer(f, quoting=csv.QUOTE_ALL)
            
            w.writerow([self.entry1.get().upper(), self.entry2.get().upper()])
            
    def merge_file(self):
        
        df1 = pd.read_csv(r'T:\FISCAL\FY 2019\PURCHASING 2019\P2P RAW DATA\MRONSTEROIDS.csv', 
                          encoding='windows-1252', dtype='str')

        # USE THE ORIGINAL P2P REPORT TO MERGE, THEN SAVE AS A NEW NAME
        df2 = pd.read_csv(r'T:\FISCAL\FY 2019\PURCHASING 2019\P2P RAW DATA\COPYP2PJAN17TOAUG18.csv', thousands=',',
                             skiprows=[1], header=[1], encoding='windows-1252', dtype='str')
        
        requisitioner_list = ['Robinson Debra', 'Walton Timothy', 'Rhoads Jay', 'Garcia Karen', 
                              'Birdwell Diana', 'Eckert Lauren']
        
        df3 = df2.loc[df2['Requisitioner Name'].isin(requisitioner_list)]

        df4 = pd.merge(df1, df3, on='Requisition ID', how='right')

        df4.to_csv(r'T:\FISCAL\FY 2019\PURCHASING 2019\P2P RAW DATA\p2pautoreport.csv', encoding='windows-1252', index=False)
        
    def clear_textbox(self):
        
        self.entry1.delete(0, 'end')
        self.entry2.delete(0, 'end')
        
    def combo_command(self):
        
        self.check_popup.destroy()
        self.write_file()
        self.merge_file()
        self.clear_textbox()
    
class SearchPage(tk.Frame):
    
    def __init__(self, parent, controller):
        
        tk.Frame.__init__(self,parent)
        label = ttk.Label(self, text="Select Search Option", font=LARGE_FONT)
        label.pack(pady=10,padx=10)
        
        task_button = ttk.Button(self, text='      Search By SCTASK      ', command= lambda: controller.show_frame(TaskPage))
        task_button.pack()
        
        req_button = ttk.Button(self, text='    Search By Requistion    ', command= lambda: controller.show_frame(ReqPage))
        req_button.pack()
                                  
        po_button = ttk.Button(self, text='Search By Purchase Order', command= lambda: controller.show_frame(PoPage))
        po_button.pack()
        
        rec_button = ttk.Button(self, text='       Search By Receipt       ', command= lambda: controller.show_frame(RecPage))
        rec_button.pack()
        
        voucher_button = ttk.Button(self, text='      Search By Voucher      ', 
                                    command= lambda: controller.show_frame(VoucherPage))
        voucher_button.pack()
        
        home_button = ttk.Button(self, text='                 Home                 ', command= lambda: controller.show_frame(HomePage))
        home_button.pack()


class ReqPage(tk.Frame):
    
    def __init__(self, parent, controller):
        
        tk.Frame.__init__(self,parent)
        label = ttk.Label(self, text="Requisition Search", font=LARGE_FONT)
        label.pack(pady=10,padx=10)
        
        self.label1 = ttk.Label(self, text='Enter Requisition ID: ')
        self.req_entry = ttk.Entry(self)
        self.label1.pack()
        self.req_entry.pack()
        self.req_entry.focus_set()
        
        req_button = ttk.Button(self, text='Search', command=self.req_search)
        req_button.pack()
        
        clear_button = ttk.Button(self, text='Clear', command=self.clear_textbox)
        clear_button.pack()
        
        back_button = ttk.Button(self, text='Back', command= lambda: controller.show_frame(SearchPage))
        back_button.pack()
        
        home_button = ttk.Button(self, text='Home', command= lambda: controller.show_frame(HomePage))
        home_button.pack()
        
    def req_search(self):
        
        window = tk.Tk()
        window.geometry('1000x500')
            
        frame = tk.Frame(window)
        frame.pack()
        
        req_df = pd.read_csv(r'T:\FISCAL\FY 2019\PURCHASING 2019\P2P RAW DATA\p2pautoreport.csv',encoding='windows-1252'
                             ,low_memory=False)
        pd.options.display.max_columns = None
        pd.set_option('display.max_colwidth', -1)
        req_df = req_df.applymap(str)
        
        p2p_df = req_df[['Ticket Number','Requisition ID','Requisition Name','Requisitioner Name','Requisition Status',
                         'Requisition Date','Requisition Line Nbr','Item Description','Buyer Name','RFQ Status',
                         'RFQ Open Date','RFQ Dispatch Date','PO Business Unit','PO Number','PO Date',
                         'PO Buyer Name','PO Line','Contract ID','Contract Line Number','PO Status','PO Budget Check Status',
                         'PO Quantity','PO Amount','PO Vendor Name','Comp. Object PO','Accounting Year PO','DDO PO',
                         'Department ID PO','Fund Code PO','Class Field PO','Project CostinG Business Unit PO',
                         'Project ID PO','PC Activity ID PO','PC Resource Type PO','Receipt ID','Receipt Updated By',
                         'Receipt Date','Receipt Line','Receipt Quantity','Receipt Status','Voucher ID','Voucher Entered Date',
                         'Voucher Amount','Invoice ID','Invoice Date','Service Start Date','Service End Date',
                         'Total PO Amount','Total Amount Received']]
        
        req_output = p2p_df.loc[req_df['Requisition ID'].str.contains(self.req_entry.get(), na=False)]
        
        scrolly = ttk.Scrollbar(frame, orient='vertical')
        scrollx = ttk.Scrollbar(frame, orient='horizontal')
        scrolly.pack(side='right', fill='y')
        scrollx.pack(side='bottom', fill='x')
        
        self.t1=tk.Text(frame,height=500,width=1000, wrap='none', xscrollcommand=scrollx.set, yscrollcommand=scrolly.set)
        self.t1.config(wrap='none')
        self.t1.pack(fill='both', expand=True)
        self.t1.insert(tk.END,req_output)
        
        scrolly.config(command=self.t1.yview)
        scrollx.config(command=self.t1.xview)
        
    def clear_textbox(self):
        self.req_entry.delete(0, 'end')
        
        
class PoPage(tk.Frame):
    
    def __init__(self, parent, controller):
        
        tk.Frame.__init__(self,parent)
        label = ttk.Label(self, text="PO Search", font=LARGE_FONT)
        label.pack(pady=10,padx=10)
        
        self.label1 = ttk.Label(self, text='Enter PO ID: ')
        self.po_entry = ttk.Entry(self)
        self.label1.pack()
        self.po_entry.pack()
        self.po_entry.focus_set()
        
        po_button = ttk.Button(self, text='Search', command=self.po_search)
        po_button.pack()
        
        clear_button = ttk.Button(self, text='Clear', command=self.clear_textbox)
        clear_button.pack()
        
        back_button = ttk.Button(self, text='Back', command= lambda: controller.show_frame(SearchPage))
        back_button.pack()
        
        home_button = ttk.Button(self, text='Home', command= lambda: controller.show_frame(HomePage))
        home_button.pack()
        
    def po_search(self):
        
        window = tk.Tk()
        window.geometry('1000x500')
            
        frame = tk.Frame(window)
        frame.pack()
        
        po_df = pd.read_csv(r'T:\FISCAL\FY 2019\PURCHASING 2019\P2P RAW DATA\p2pautoreport.csv',encoding='windows-1252')
        pd.options.display.max_columns = None
        pd.set_option('display.max_colwidth', -1)
        po_df = po_df.applymap(str)
        
        p2p_df = po_df[['Ticket Number','Requisition ID','Requisition Name','Requisitioner Name','Requisition Status',
                         'Requisition Date','Requisition Line Nbr','Item Description','Buyer Name','RFQ Status',
                         'RFQ Open Date','RFQ Dispatch Date','PO Business Unit','PO Number','PO Date',
                         'PO Buyer Name','PO Line','Contract ID','Contract Line Number','PO Status','PO Budget Check Status',
                         'PO Quantity','PO Amount','PO Vendor Name','Comp. Object PO','Accounting Year PO','DDO PO',
                         'Department ID PO','Fund Code PO','Class Field PO','Project CostinG Business Unit PO',
                         'Project ID PO','PC Activity ID PO','PC Resource Type PO','Receipt ID','Receipt Updated By',
                         'Receipt Date','Receipt Line','Receipt Quantity','Receipt Status','Voucher ID','Voucher Entered Date',
                         'Voucher Amount','Invoice ID','Invoice Date','Service Start Date','Service End Date',
                         'Total PO Amount','Total Amount Received']]
        
        po_output = p2p_df.loc[req_df['PO Number'] == self.po_entry.get()]
        
        scrolly = ttk.Scrollbar(frame, orient='vertical')
        scrollx = ttk.Scrollbar(frame, orient='horizontal')
        scrolly.pack(side='right', fill='y')
        scrollx.pack(side='bottom', fill='x')
        
        self.t1=tk.Text(frame,height=500,width=1000, wrap='none', xscrollcommand=scrollx.set, yscrollcommand=scrolly.set)
        self.t1.config(wrap='none')
        self.t1.pack(fill='both', expand=True)
        self.t1.insert(tk.END,po_output)
        
        scrolly.config(command=self.t1.yview)
        scrollx.config(command=self.t1.xview)
        
    def clear_textbox(self):
        self.po_entry.delete(0, 'end')
        
        
class RecPage(tk.Frame):
    
    def __init__(self, parent, controller):
        
        tk.Frame.__init__(self,parent)
        label = ttk.Label(self, text="Receipt Search", font=LARGE_FONT)
        label.pack(pady=10,padx=10)
        
        self.label1 = ttk.Label(self, text='Enter Receipt ID: ')
        self.rec_entry = ttk.Entry(self)
        self.label1.pack()
        self.rec_entry.pack()
        self.rec_entry.focus_set()
        
        rec_button = ttk.Button(self, text='Search', command=self.rec_search)
        rec_button.pack()
        
        clear_button = ttk.Button(self, text='Clear', command=self.clear_textbox)
        clear_button.pack()
        
        back_button = ttk.Button(self, text='Back', command= lambda: controller.show_frame(SearchPage))
        back_button.pack()
        
        home_button = ttk.Button(self, text='Home', command= lambda: controller.show_frame(HomePage))
        home_button.pack()
        
    def rec_search(self):
        
        window = tk.Tk()
        window.geometry('1000x500')
        
        frame = tk.Frame(window)
        frame.pack()
        
        rec_df = pd.read_csv(r'T:\FISCAL\FY 2019\PURCHASING 2019\P2P RAW DATA\p2pautoreport.csv',encoding='windows-1252', dtype='str')
        pd.options.display.max_columns = None
        pd.set_option('display.max_colwidth', -1)
        rec_df = rec_df.applymap(str)
        
        p2p_df = rec_df[['Ticket Number','Requisition ID','Requisition Name','Requisitioner Name','Requisition Status',
                         'Requisition Date','Requisition Line Nbr','Item Description','Buyer Name','RFQ Status',
                         'RFQ Open Date','RFQ Dispatch Date','PO Business Unit','PO Number','PO Date',
                         'PO Buyer Name','PO Line','Contract ID','Contract Line Number','PO Status','PO Budget Check Status',
                         'PO Quantity','PO Amount','PO Vendor Name','Comp. Object PO','Accounting Year PO','DDO PO',
                         'Department ID PO','Fund Code PO','Class Field PO','Project CostinG Business Unit PO',
                         'Project ID PO','PC Activity ID PO','PC Resource Type PO','Receipt ID','Receipt Updated By',
                         'Receipt Date','Receipt Line','Receipt Quantity','Receipt Status','Voucher ID','Voucher Entered Date',
                         'Voucher Amount','Invoice ID','Invoice Date','Service Start Date','Service End Date',
                         'Total PO Amount','Total Amount Received']]
        
        rec_output = p2p_df.loc[rec_df['Receipt ID'] == self.rec_entry.get()]
        
        scrolly = ttk.Scrollbar(frame, orient='vertical')
        scrollx = ttk.Scrollbar(frame, orient='horizontal')
        scrolly.pack(side='right', fill='y')
        scrollx.pack(side='bottom', fill='x')
        
        self.t1=tk.Text(frame,height=500,width=1000, wrap='none', xscrollcommand=scrollx.set, yscrollcommand=scrolly.set)
        self.t1.config(wrap='none')
        self.t1.pack(fill='both', expand=True)
        self.t1.insert(tk.END,rec_output)
        
        scrolly.config(command=self.t1.yview)
        scrollx.config(command=self.t1.xview)
        
    def clear_textbox(self):
        self.rec_entry.delete(0, 'end')
        
        
class TaskPage(tk.Frame):
    
    def __init__(self, parent, controller):
        
        tk.Frame.__init__(self,parent)
        label = ttk.Label(self, text="SCTASK Search", font=LARGE_FONT)
        label.pack(pady=10,padx=10)
        
        self.label1 = ttk.Label(self, text='Enter SCTASK: ')
        self.task_entry = ttk.Entry(self)
        self.label1.pack()
        self.task_entry.pack()
        self.task_entry.focus_set()
        
        task_button = ttk.Button(self, text='Search', command=self.task_search)
        task_button.pack()
        
        clear_button = ttk.Button(self, text='Clear', command=self.clear_textbox)
        clear_button.pack()
        
        back_button = ttk.Button(self, text='Back', command= lambda: controller.show_frame(SearchPage))
        back_button.pack()
        
        home_button = ttk.Button(self, text='Home', command= lambda: controller.show_frame(HomePage))
        home_button.pack()
        
    def task_search(self):
        
        window = tk.Tk()
        window.geometry('1000x500')
        
        frame = tk.Frame(window)
        frame.pack()
        
        rec_df = pd.read_csv(r'T:\FISCAL\FY 2019\PURCHASING 2019\P2P RAW DATA\p2pautoreport.csv',encoding='windows-1252', dtype='str')
        pd.options.display.max_columns = None
        pd.set_option('display.max_colwidth', -1)
        rec_df = rec_df.applymap(str)
        
        p2p_df = rec_df[['Ticket Number','Requisition ID','Requisition Name','Requisitioner Name','Requisition Status',
                         'Requisition Date','Requisition Line Nbr','Item Description','Buyer Name','RFQ Status',
                         'RFQ Open Date','RFQ Dispatch Date','PO Business Unit','PO Number','PO Date',
                         'PO Buyer Name','PO Line','Contract ID','Contract Line Number','PO Status','PO Budget Check Status',
                         'PO Quantity','PO Amount','PO Vendor Name','Comp. Object PO','Accounting Year PO','DDO PO',
                         'Department ID PO','Fund Code PO','Class Field PO','Project CostinG Business Unit PO',
                         'Project ID PO','PC Activity ID PO','PC Resource Type PO','Receipt ID','Receipt Updated By',
                         'Receipt Date','Receipt Line','Receipt Quantity','Receipt Status','Voucher ID','Voucher Entered Date',
                         'Voucher Amount','Invoice ID','Invoice Date','Service Start Date','Service End Date',
                         'Total PO Amount','Total Amount Received']]
        
        task_output = p2p_df.loc[rec_df['Ticket Number'] == self.task_entry.get().upper()]
        
        scrolly = ttk.Scrollbar(frame, orient='vertical')
        scrollx = ttk.Scrollbar(frame, orient='horizontal')
        scrolly.pack(side='right', fill='y')
        scrollx.pack(side='bottom', fill='x')
        
        self.t1=tk.Text(frame,height=500,width=1000, wrap='none', xscrollcommand=scrollx.set, yscrollcommand=scrolly.set)
        self.t1.config(wrap='none')
        self.t1.pack(fill='both', expand=True)
        self.t1.insert(tk.END,task_output)
        
        scrolly.config(command=self.t1.yview)
        scrollx.config(command=self.t1.xview)
        
    def clear_textbox(self):
        self.task_entry.delete(0, 'end')
        
        
class VoucherPage(tk.Frame):
    
    def __init__(self, parent, controller):
        
        tk.Frame.__init__(self,parent)
        label = ttk.Label(self, text="Voucher Search", font=LARGE_FONT)
        label.pack(pady=10,padx=10)
        
        self.label1 = ttk.Label(self, text='Enter Voucher ID: ')
        self.voucher_entry = ttk.Entry(self)
        self.label1.pack()
        self.voucher_entry.pack()
        self.voucher_entry.focus_set()
        
        voucher_button = ttk.Button(self, text='Search', command=self.voucher_search)
        voucher_button.pack()
        
        clear_button = ttk.Button(self, text='Clear', command=self.clear_textbox)
        clear_button.pack()
        
        back_button = ttk.Button(self, text='Back', command= lambda: controller.show_frame(SearchPage))
        back_button.pack()
        
        home_button = ttk.Button(self, text='Home', command= lambda: controller.show_frame(HomePage))
        home_button.pack()
        
    def voucher_search(self):
        
        window = tk.Tk()
        window.geometry('1000x500')
        
        frame = tk.Frame(window)
        frame.pack()
        
        rec_df = pd.read_csv(r'T:\FISCAL\FY 2019\PURCHASING 2019\P2P RAW DATA\p2pautoreport.csv',encoding='windows-1252', dtype='str')
        pd.options.display.max_columns = None
        pd.set_option('display.max_colwidth', -1)
        rec_df = rec_df.applymap(str)
        
        p2p_df = rec_df[['Ticket Number','Requisition ID','Requisition Name','Requisitioner Name','Requisition Status',
                         'Requisition Date','Requisition Line Nbr','Item Description','Buyer Name','RFQ Status',
                         'RFQ Open Date','RFQ Dispatch Date','PO Business Unit','PO Number','PO Date',
                         'PO Buyer Name','PO Line','Contract ID','Contract Line Number','PO Status','PO Budget Check Status',
                         'PO Quantity','PO Amount','PO Vendor Name','Comp. Object PO','Accounting Year PO','DDO PO',
                         'Department ID PO','Fund Code PO','Class Field PO','Project CostinG Business Unit PO',
                         'Project ID PO','PC Activity ID PO','PC Resource Type PO','Receipt ID','Receipt Updated By',
                         'Receipt Date','Receipt Line','Receipt Quantity','Receipt Status','Voucher ID','Voucher Entered Date',
                         'Voucher Amount','Invoice ID','Invoice Date','Service Start Date','Service End Date',
                         'Total PO Amount','Total Amount Received']]
        
        voucher_output = p2p_df.loc[rec_df['Ticket Number'] == self.voucher_entry.get()]
        
        scrolly = ttk.Scrollbar(frame, orient='vertical')
        scrollx = ttk.Scrollbar(frame, orient='horizontal')
        scrolly.pack(side='right', fill='y')
        scrollx.pack(side='bottom', fill='x')
        
        self.t1=tk.Text(frame,height=500,width=1000, wrap='none', xscrollcommand=scrollx.set, yscrollcommand=scrolly.set)
        self.t1.config(wrap='none')
        self.t1.pack(fill='both', expand=True)
        self.t1.insert(tk.END,voucher_output)
        
        scrolly.config(command=self.t1.yview)
        scrollx.config(command=self.t1.xview)
        
    def clear_textbox(self):
        self.voucher_entry.delete(0, 'end')
        

class ReportPage(tk.Frame):
    
    def __init__(self, parent, controller):
        
        tk.Frame.__init__(self,parent)
        label = ttk.Label(self, text="Select a Report to Run", font=LARGE_FONT)
        label.pack(pady=10,padx=10)
        
        req_button = ttk.Button(self, text='       Req to PO        ', command= self.req2po)
        req_button.pack()
                                  
        po_button = ttk.Button(self, text='     PO to Receipt    ', command= self.po2rec)
        po_button.pack()
        
        rec_button = ttk.Button(self, text='Receipt to Voucher', command= self.rec2voucher)
        rec_button.pack()
        
        bal_button = ttk.Button(self, text='Remaining Balance', command= self.remainingbal)
        bal_button.pack()
        
        home_button = ttk.Button(self, text='           Home           ', command= lambda: controller.show_frame(HomePage))
        home_button.pack()
        
    def req2po(self):
        
        df = pd.read_csv(r'T:\FISCAL\FY 2019\PURCHASING 2019\P2P RAW DATA\p2pautoreport.csv',encoding='windows-1252', dtype='str')
        pd.options.display.max_columns = None
        pd.set_option('display.max_colwidth', -1)
        df = df.applymap(str)
        
        df1 = df[['Ticket Number','Requisition ID','Requisition Name','Requisitioner Name','Requisition Status',
                  'Requisition Date', 'Requisition Approval Date', 'Requisition Line Nbr','Item Description', 
                  'Buyer Name','Comp. Object Req','Accounting Year Req','Department ID Req','Fund Code Req','Class Field Req', 
                  'Project CostinG Business Unit Req','Project ID Req','PC Activity ID Req','PC Resource Type Req','PO Number']]

        requisitioner_list = ['Robinson Debra', 'Walton Timothy', 'Rhoads Jay', 'Garcia Karen', 'Birdwell Diana']
        df2 = df1[df1['Requisitioner Name'].isin(requisitioner_list)]
        
        df3 = df2[(df2['Requisition ID'] != ' ') & (df2['PO Number'] == ' ')]
        
        df3.to_csv(r'T:\FISCAL\FY 2019\PURCHASING 2019\P2P RAW DATA\req2po.csv', encoding='windows-1252', index=False)

        os.startfile('T:\\FISCAL\\FY 2019\\PURCHASING 2019\\P2P RAW DATA\\req2po.csv', 'open')
        
    def po2rec(self):
        
        df = pd.read_csv(r'T:\FISCAL\FY 2019\PURCHASING 2019\P2P RAW DATA\p2pautoreport.csv',encoding='windows-1252', dtype='str')
        pd.options.display.max_columns = None
        pd.set_option('display.max_colwidth', -1)
        df = df.applymap(str)
        
        df1 = df[['Ticket Number','Requisition ID','Requisition Name','Requisitioner Name','Requisition Status',
                  'Requisition Date','Requisition Line Nbr','Item Description','Buyer Name','PO Business Unit',
                  'PO Number','PO Date','PO Buyer Name','PO Line','Contract ID','Contract Line Number','PO Status',
                  'PO Budget Check Status','PO Quantity','PO Amount','PO Vendor Name','Comp. Object PO','Accounting Year PO',
                  'DDO PO','Department ID PO','Fund Code PO','Class Field PO','Project CostinG Business Unit PO',
                  'Project ID PO','PC Activity ID PO','PC Resource Type PO','Receipt ID','Total PO Amount',
                  'Total Amount Received']]

        requisitioner_list = ['Robinson Debra', 'Walton Timothy', 'Rhoads Jay', 'Garcia Karen', 'Birdwell Diana']
        df2 = df1[df1['Requisitioner Name'].isin(requisitioner_list)]
        
        df3 = df2.loc[df2['PO Status'].isin(['Dispatched', 'Open'])]
        
        df4 = df3[(df3['PO Number'] != ' ') & (df3['Receipt ID'] == ' ')]
        
        df4.to_csv(r'T:\FISCAL\FY 2019\PURCHASING 2019\P2P RAW DATA\po2receipt.csv', encoding='windows-1252', index=False)

        os.startfile('T:\\FISCAL\\FY 2019\\PURCHASING 2019\\P2P RAW DATA\\po2receipt.csv', 'open')
        
    def rec2voucher(self):
        
        df = pd.read_csv(r'T:\FISCAL\FY 2019\PURCHASING 2019\P2P RAW DATA\p2pautoreport.csv',encoding='windows-1252', dtype='str')
        pd.options.display.max_columns = None
        pd.set_option('display.max_colwidth', -1)
        df = df.applymap(str)
        
        df1 = df[['Ticket Number','Requisition ID','Requisition Name','Requisitioner Name','Requisition Status',
                  'Requisition Date','Requisition Line Nbr','Item Description','Buyer Name','RFQ Status',
                  'RFQ Open Date','RFQ Dispatch Date','PO Business Unit','PO Number','PO Date',
                  'PO Buyer Name','PO Line','Contract ID','Contract Line Number','PO Status','PO Budget Check Status',
                  'PO Quantity','PO Amount','PO Vendor Name','Comp. Object PO','Accounting Year PO','DDO PO',
                  'Department ID PO','Fund Code PO','Class Field PO','Project CostinG Business Unit PO',  
                  'Project ID PO','PC Activity ID PO','PC Resource Type PO','Receipt ID','Receipt Updated By',
                  'Receipt Date','Receipt Line','Receipt Quantity','Receipt Status','Voucher ID','Voucher Entered Date',
                  'Voucher Amount','Invoice ID','Invoice Date','Service Start Date','Service End Date',
                  'Total PO Amount','Total Amount Received']]

        requisitioner_list = ['Robinson Debra', 'Walton Timothy', 'Rhoads Jay', 'Garcia Karen', 'Birdwell Diana']
        df2 = df1[df1['Requisitioner Name'].isin(requisitioner_list)]
        
        df3 = df2.loc[df2['PO Status'].isin(['Dispatched', 'Open'])]
        
        df4 = df3[(df3['Receipt ID'] != ' ') & (df3['Voucher ID'] == ' ')]
        
        df5 = df4[df4['Receipt Status'] != 'Canceled']
        
        df5.to_csv(r'T:\FISCAL\FY 2019\PURCHASING 2019\P2P RAW DATA\receipt2voucher.csv', encoding='windows-1252', index=False)

        os.startfile('T:\\FISCAL\\FY 2019\\PURCHASING 2019\\P2P RAW DATA\\receipt2voucher.csv', 'open')
        
    def remainingbal(self):
        
        df = pd.read_csv(r'T:\FISCAL\FY 2019\PURCHASING 2019\P2P RAW DATA\p2pautoreport.csv',encoding='windows-1252', dtype='str')
        pd.options.display.max_columns = None
        pd.set_option('display.max_colwidth', -1)
        df = df.applymap(str)
        
        df1 = df[['Ticket Number','Requisition ID','Requisition Name','Requisitioner Name','Requisition Status',
                  'Requisition Date','Requisition Line Nbr','Item Description','Buyer Name','RFQ Status',
                  'RFQ Open Date','RFQ Dispatch Date','PO Business Unit','PO Number','PO Date',
                  'PO Buyer Name','PO Line','Contract ID','Contract Line Number','PO Status','PO Budget Check Status',
                  'PO Quantity','PO Amount','PO Vendor Name','Comp. Object PO','Accounting Year PO','DDO PO',
                  'Department ID PO','Fund Code PO','Class Field PO','Project CostinG Business Unit PO',  
                  'Project ID PO','PC Activity ID PO','PC Resource Type PO','Receipt ID','Receipt Updated By',
                  'Receipt Date','Receipt Line','Receipt Quantity','Receipt Status','Voucher ID','Voucher Entered Date',
                  'Voucher Amount','Invoice ID','Invoice Date','Service Start Date','Service End Date',
                  'Total PO Amount','Total Amount Received']]

        requisitioner_list = ['Robinson Debra', 'Walton Timothy', 'Rhoads Jay', 'Garcia Karen', 'Birdwell Diana']
        df2 = df1[df1['Requisitioner Name'].isin(requisitioner_list)]
        
        df3 = df2[(df2['Total PO Amount'] != df2['Total Amount Received'])]
        
        df3 = df2.loc[df2['PO Status'].isin(['Dispatched', 'Open'])]
        
        df4 = df3[(df3['Total PO Amount'] != df3['Total Amount Received'])]
        
        df4.to_csv(r'T:\FISCAL\FY 2019\PURCHASING 2019\P2P RAW DATA\remainingbalance.csv', encoding='windows-1252', index=False)

        os.startfile('T:\\FISCAL\\FY 2019\\PURCHASING 2019\\P2P RAW DATA\\remainingbalance.csv', 'open')
     
    
app = P2P_Gui()
app.mainloop()

# Turn py file into .exe
# C:\...pyinstaller.exe --onefile --windowed C:\...filename.py
