import webbrowser as wb
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.common.by import By
from selenium.webdriver.support import expected_conditions as EC

p2p_url = 'https://fin.txdot.gov/psp/psfinpd/EMPLOYEE/ERP/c/X_PO_TXDOT_MENU.X_PO_REQ_VCH_CMP.GBL?Folder=MYFAVORITES'

driver = webdriver.Chrome()
driver.get(p2p_url)

enter_user = driver.find_element_by_id('userid')
enter_user.send_keys('TWALTON')

enter_password = driver.find_element_by_id('pwd')
enter_password.send_keys('Cowboy_26')

driver.find_element_by_css_selector('.ps-button').click()

WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.XPATH, '//*[@id="ptifrmtgtframe"]')))
driver.switch_to.frame(driver.find_element_by_xpath('//*[@id="ptifrmtgtframe"]'))

enter_control = driver.find_element_by_xpath('//*[@id="X_PO_RQVC_RNCTL_RUN_CNTL_ID"]')
enter_control.send_keys('P2P_IMD')
driver.find_element_by_css_selector('.PSPUSHBUTTONTBSEARCH').click()

WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.XPATH, '//*[@id="PRCSRQSTDLG_WRK_LOADPRCSRQSTDLGPB"]')))
driver.find_element_by_css_selector('.PSPUSHBUTTON').click()

driver.switch_to_default_content()
WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.XPATH, '//*[@id="ptModFrame_0"]')))
driver.switch_to.frame(driver.find_element_by_xpath('//*[@id="ptModFrame_0"]'))
driver.find_element_by_css_selector('.PSPUSHBUTTONTBOK').click()

WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.XPATH, '//*[@id="ptifrmtgtframe"]')))
driver.switch_to_default_content()
driver.switch_to.frame(driver.find_element_by_xpath('//*[@id="ptifrmtgtframe"]'))
driver.find_element_by_id('PRCSRQSTDLG_WRK_LOADRPTLIST').click()
